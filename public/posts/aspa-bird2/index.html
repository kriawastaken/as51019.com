<!DOCTYPE html>
<html lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  
    <title>ASPA path validation in BIRD2 with Routinator and TypeScript :: AS51019</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Recently (or not so recently?) some RFCs were published on the topic of a new standard in routing security. This is the ASPA (Autonomous System Provider Authorization) Objects system.
Even more recently the first route leak prevented by ASPA ocurred, in february 2023.
I thought it might be fun to explore if we could achieve the same thing, only with BIRD2, some open source tools, and a bit of TypeScript. So let&rsquo;s dive in!
" />
<meta name="keywords" content=", " />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="http://localhost:1313/posts/aspa-bird2/" />






  
  
  
  
  
  <link rel="stylesheet" href="http://localhost:1313/styles.css">







  <link rel="shortcut icon" href="http://localhost:1313/img/theme-colors/blue.png">
  <link rel="apple-touch-icon" href="http://localhost:1313/img/theme-colors/blue.png">



<meta name="twitter:card" content="summary" />

  
    <meta name="twitter:site" content="" />
  
    <meta name="twitter:creator" content="kjartanhr" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="ASPA path validation in BIRD2 with Routinator and TypeScript">
<meta property="og:description" content="Recently (or not so recently?) some RFCs were published on the topic of a new standard in routing security. This is the ASPA (Autonomous System Provider Authorization) Objects system.
Even more recently the first route leak prevented by ASPA ocurred, in february 2023.
I thought it might be fun to explore if we could achieve the same thing, only with BIRD2, some open source tools, and a bit of TypeScript. So let&rsquo;s dive in!
" />
<meta property="og:url" content="http://localhost:1313/posts/aspa-bird2/" />
<meta property="og:site_name" content="AS51019" />

  
  
  <meta property="og:image" content="http://localhost:1313/">

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">


  <meta property="article:published_time" content="2024-05-02 23:27:27 &#43;0000 UTC" />









<script type="module" defer>
    import { polyfillCountryFlagEmojis } from "https://cdn.skypack.dev/country-flag-emoji-polyfill";
    polyfillCountryFlagEmojis();
</script>


<script src="https://unpkg.com/htmx.org@1.9.12" integrity="sha384-ujb1lZYygJmzgSwoxRggbCHcjc0rB2XoQrxeTUQyRjrOnlCoYta87iKBWq3EsdM2" crossorigin="anonymous"></script>





</head>
<body class="blue" hx-boost="true">


<div class="container headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    
    <img src="/as51019-clean.min.png" alt="AS51019 uwu logo" data-maxres-src="/as51019-clean.png" />
  </div>
</a>

    </div>
    
      <ul class="menu menu--mobile">
  <li class="menu__trigger">Menu&nbsp;▾</li>
  <li>
    <ul class="menu__dropdown">
      
        
          <li><a href="/about">About</a></li>
        
      
        
          <li><a href="/communities">BGP communities</a></li>
        
      
        
          <li><a href="/presence">Presence</a></li>
        
      
      
    </ul>
  </li>
</ul>

    
    
  </div>
  
    <nav class="navigation-menu">
  <ul class="navigation-menu__inner menu--desktop">
    
      
        
          <li><a href="/about" >About</a></li>
        
      
        
          <li><a href="/communities" >BGP communities</a></li>
        
      
      
        <li>
          <ul class="menu">
            <li class="menu__trigger">Show more&nbsp;▾</li>
            <li>
              <ul class="menu__dropdown">
                
                  
                    <li><a href="/presence" >Presence</a></li>
                  
                
              </ul>
            </li>
          </ul>
        </li>
      
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<article class="post">
  <h1 class="post-title">
    <a href="http://localhost:1313/posts/aspa-bird2/">ASPA path validation in BIRD2 with Routinator and TypeScript</a>
  </h1>
  <div class="post-meta"><time class="post-date">2024-05-02</time><span class="post-author">Kjartan Hrafnkelsson</span></div>

  
    <span class="post-tags">
      
      #<a href="http://localhost:1313/tags/routing-security/">routing security</a>&nbsp;
      
      #<a href="http://localhost:1313/tags/rpki/">rpki</a>&nbsp;
      
      #<a href="http://localhost:1313/tags/aspa/">aspa</a>&nbsp;
      
    </span>
  
  


  

  <div class="post-content"><div>
        <p>Recently (or not so recently?) some RFCs were published on the topic of a new standard in routing security. This is the ASPA (Autonomous System Provider Authorization) Objects system.</p>
<p>Even more recently <a href="https://manrs.org/2023/02/unpacking-the-first-route-leak-prevented-by-aspa/">the first route leak prevented by ASPA</a> ocurred, in february 2023.</p>
<p>I thought it might be fun to explore if we could achieve the same thing, only with BIRD2, some open source tools, and a bit of TypeScript. So let&rsquo;s dive in!</p>
<h1 id="rpki-client">rpki-client<a href="#rpki-client" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<p>Initially my intuition for this was to use <code>rpki-client</code> as I had seen this tool used by Job Snijders and other big names in the &ldquo;routing security space&rdquo;.</p>
<p>The maintainers of <code>rpki-client</code> also happened to publish <a href="https://console.rpki-client.org/">a website</a> showing dumps given by <code>rpki-client</code> at certain intervals in a web-accessible form. <a href="https://console.rpki-client.org/aspa.html">There even is an ASPA page!</a>. Cool!</p>
<p>Unfortunately I only ran into issues with <code>rpki-client</code>. It&rsquo;d do funky stuff like not being able to connect to most repos and run out of memory, for whatever reason.</p>
<p>So I changed course.</p>
<h1 id="routinator">Routinator<a href="#routinator" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<p>When I was doing this I happened to be in a call in the <a href="https://discord.gg/ipv6">Network: IPv6 Discord</a> where Lee, a comrade from the networking space, pointed out that NLnet&rsquo;s Routinator could do ASPA. Indeed, <a href="https://routinator.docs.nlnetlabs.nl/en/stable/advanced-features.html#aspa">it can</a> though it requires some modification.</p>
<p>To do this we have to follow <a href="https://routinator.docs.nlnetlabs.nl/en/stable/building.html">Routinator&rsquo;s guide for compiling from source</a>. This is so we can build the software with the feature flag that enables ASPA.</p>
<p>Luckily this is pretty simple and boils down to running the correct command after installing rust on your system:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># some build tools</span>
</span></span><span style="display:flex;"><span>apt install build-essential
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># install rust (please dont pipe to bash in production)</span>
</span></span><span style="display:flex;"><span>curl --proto <span style="color:#e6db74">&#39;=https&#39;</span> --tlsv1.2 -sSf https://sh.rustup.rs | sh
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># add cargo to $PATH (note the period, it&#39;s important)</span>
</span></span><span style="display:flex;"><span>. <span style="color:#e6db74">&#34;</span>$HOME<span style="color:#e6db74">/.cargo/env&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># build routinator with aspa</span>
</span></span><span style="display:flex;"><span>cargo install --locked --features aspa routinator
</span></span></code></pre></div><p>Now we can run <code>routinator</code> with the <code>--enable-aspa</code> flag. Cool!</p>
<h1 id="getting-current-aspa-data">Getting current ASPA data<a href="#getting-current-aspa-data" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<p>Now, to do anything useful here we have to retrieve all current ASPA ASAs (I think these are like certificates?) from the RPKI publication servers around the world.</p>
<p>Unfortunately, since this proposed standard is so new (and not even accepted yet - for the record) there exists no TCP transport mechanism (and certainly no implementation for it in BIRD2) to import ASPA data into a routing daemon. Instead we&rsquo;ll have to move the data ourselves and make it work with BIRD2 ourselves.</p>
<p>Routinator makes this <em>really easy</em> and lets us output to JSON, just what we need to do some scripting with Deno later:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>routinator --enable-aspa vrps -f json -o dump.json --no-route-origins --no-router-keys
</span></span></code></pre></div><p>What&rsquo;s happening here is quite simple. We run <code>routinator</code> with the <code>--enable-aspa</code> flag to use ASPA features. Then we run the <code>vrps</code> subcommand and pass the following options to it:</p>
<ul>
<li><code>-f json</code> - output to JSON format.</li>
<li><code>-o dump.json</code> - write the output to a new file called <code>dump.json</code>.</li>
<li><code>--no-route-origins</code> exclude ROAs..</li>
<li><code>--no-router-keys</code> exclude router keys.</li>
</ul>
<p>This command does take a while to run, so it probably fits in nicely as a cronjob. But once it finishes we get a file that looks <a href="/posts/aspa-bird2/dump.json">something like this</a>.</p>
<p>Now we just have to use it.</p>
<h1 id="writing-a-filter-function-for-bird2">Writing a filter function for BIRD2<a href="#writing-a-filter-function-for-bird2" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<p>I&rsquo;ll be the first to admit to being no BIRD expert but I do have a few tricks up my sleeve. AS path filtering is one of them.</p>
<p>The filter (or I guess conditional) that makes what I want to achieve possible is the following:</p>
<pre tabindex="0"><code>bgp_path ~ [= * ASN * =]
</code></pre><p>In summary it will return true if the specified ASN exists within the AS path. You can also pass multiple ASNs to it and check for order:</p>
<pre tabindex="0"><code>bgp_path ~ [= * ASN1 ASN2 * =] )
</code></pre><p>In this example, <code>ASN1</code> would be <code>ASN2</code>&rsquo;s permitted carrier (&ldquo;provider&rdquo; in ASPA speak).</p>
<p>Using these two conditions we can quite easily create a functional, but rather sloppy, filter function for published ASAs.</p>
<p>The pseudocode looks a little like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">boolean</span> is aspa <span style="color:#a6e22e">valid</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (asa publisher asn in path) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (provider1 asn before asa publisher asn in path) <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (provider2 asn before asa publisher asn in path) <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (providerN asn before asa publisher asn in path) <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>; 
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>I&rsquo;m sure this code could be improved for performance and efficiency - my online mates already seem to think so - but this will work for our purposes for now.</p>
<h1 id="generating-the-filter-function">Generating the filter function<a href="#generating-the-filter-function" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<p>I chose to write <a href="https://github.com/kjartanhr/routinator-aspa-json-to-bird2">a TypeScript program</a> with Deno to achieve what I&rsquo;d like to do here. Deno also conveniently allows you to &ldquo;compile&rdquo; (really it&rsquo;s just bundling) the program to a binary that can run portably, which is handy. Though the binary does end up being around 130MB in size. Yikes!</p>
<p>The program&rsquo;s 100~ lines come mostly from error handling and CLI flag boilerplate. The actual logic is 14 lines consisting of a for loop with a nested one inside it:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-typescript" data-lang="typescript"><span style="display:flex;"><span><span style="color:#66d9ef">let</span> <span style="color:#a6e22e">txt</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">const</span> {<span style="color:#a6e22e">customer</span>, <span style="color:#a6e22e">providers</span>} <span style="color:#66d9ef">of</span> <span style="color:#a6e22e">aspas</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">asn</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">customer</span>.<span style="color:#a6e22e">replace</span>(<span style="color:#a6e22e">LEADING_AS</span>, <span style="color:#e6db74">&#39;&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">txt</span> <span style="color:#f92672">+=</span> <span style="color:#e6db74">`   # does the AS path include </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">customer</span><span style="color:#e6db74">}</span><span style="color:#e6db74">?</span><span style="color:#960050;background-color:#1e0010">\</span><span style="color:#e6db74">n`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">txt</span> <span style="color:#f92672">+=</span> <span style="color:#e6db74">`   if (bgp_path ~ [= * </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">asn</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> * =]) then {</span><span style="color:#960050;background-color:#1e0010">\</span><span style="color:#e6db74">n`</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">txt</span> <span style="color:#f92672">+=</span> <span style="color:#e6db74">`       # does the AS path include [carrier&#39;s asn, </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">customer</span><span style="color:#e6db74">}</span><span style="color:#e6db74">]?</span><span style="color:#960050;background-color:#1e0010">\</span><span style="color:#e6db74">n`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">provider</span> <span style="color:#66d9ef">of</span> <span style="color:#a6e22e">providers</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">carrier</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">provider</span>.<span style="color:#a6e22e">replace</span>(<span style="color:#a6e22e">LEADING_AS</span>, <span style="color:#e6db74">&#39;&#39;</span>);
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">txt</span> <span style="color:#f92672">+=</span> <span style="color:#e6db74">`       if (bgp_path ~ [= * </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">carrier</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">asn</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> * =]) then return true;</span><span style="color:#960050;background-color:#1e0010">\</span><span style="color:#e6db74">n`</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">txt</span> <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#39;       return false;\n&#39;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">txt</span> <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#39;   }\n\n&#39;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>There are a few more lines of boilerplate but you get the gist. The resulting function definition you get from running the program looks a little like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span>function is_aspa_valid () {
</span></span><span style="display:flex;"><span>   # does the <span style="color:#66d9ef">AS</span> path include <span style="color:#66d9ef">AS945</span><span style="color:#f92672">?</span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">if</span> (bgp_path <span style="color:#f92672">~</span> [<span style="color:#f92672">=</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">945</span> <span style="color:#f92672">*</span> <span style="color:#f92672">=</span>]) then {
</span></span><span style="display:flex;"><span>       # does the <span style="color:#66d9ef">AS</span> path include [carrier<span style="color:#a6e22e">&#39;s</span> asn, <span style="color:#66d9ef">AS945</span>]<span style="color:#f92672">?</span>
</span></span><span style="display:flex;"><span>       <span style="color:#66d9ef">if</span> (bgp_path <span style="color:#f92672">~</span> [<span style="color:#f92672">=</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">174</span> <span style="color:#ae81ff">945</span> <span style="color:#f92672">*</span> <span style="color:#f92672">=</span>]) then <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>       <span style="color:#66d9ef">if</span> (bgp_path <span style="color:#f92672">~</span> [<span style="color:#f92672">=</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">1299</span> <span style="color:#ae81ff">945</span> <span style="color:#f92672">*</span> <span style="color:#f92672">=</span>]) then <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>       <span style="color:#66d9ef">if</span> (bgp_path <span style="color:#f92672">~</span> [<span style="color:#f92672">=</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">3491</span> <span style="color:#ae81ff">945</span> <span style="color:#f92672">*</span> <span style="color:#f92672">=</span>]) then <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>       <span style="color:#66d9ef">if</span> (bgp_path <span style="color:#f92672">~</span> [<span style="color:#f92672">=</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">6461</span> <span style="color:#ae81ff">945</span> <span style="color:#f92672">*</span> <span style="color:#f92672">=</span>]) then <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>       <span style="color:#66d9ef">if</span> (bgp_path <span style="color:#f92672">~</span> [<span style="color:#f92672">=</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">6939</span> <span style="color:#ae81ff">945</span> <span style="color:#f92672">*</span> <span style="color:#f92672">=</span>]) then <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>       <span style="color:#66d9ef">if</span> (bgp_path <span style="color:#f92672">~</span> [<span style="color:#f92672">=</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">7018</span> <span style="color:#ae81ff">945</span> <span style="color:#f92672">*</span> <span style="color:#f92672">=</span>]) then <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>       <span style="color:#66d9ef">if</span> (bgp_path <span style="color:#f92672">~</span> [<span style="color:#f92672">=</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">7922</span> <span style="color:#ae81ff">945</span> <span style="color:#f92672">*</span> <span style="color:#f92672">=</span>]) then <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>       <span style="color:#66d9ef">if</span> (bgp_path <span style="color:#f92672">~</span> [<span style="color:#f92672">=</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">9002</span> <span style="color:#ae81ff">945</span> <span style="color:#f92672">*</span> <span style="color:#f92672">=</span>]) then <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>       <span style="color:#66d9ef">if</span> (bgp_path <span style="color:#f92672">~</span> [<span style="color:#f92672">=</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">32097</span> <span style="color:#ae81ff">945</span> <span style="color:#f92672">*</span> <span style="color:#f92672">=</span>]) then <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>       <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>;
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   # to avoid breaking stuff, assume the path is valid <span style="color:#66d9ef">if</span> no <span style="color:#66d9ef">ASA</span> exists.
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>With that, using the generated function is as easy as shoving it in a <code>/etc/bird/functions/aspa.conf</code> file, including it in <code>bird.conf</code> and using it for filtering!</p>
<p>Using the function should look a little like this:</p>
<pre tabindex="0"><code class="language-conf" data-lang="conf">if (!is_aspa_valid()) then reject &#34;aspa: not ok&#34;;
</code></pre><p>Typing <code>birdc c</code> to reconfigure BIRD is a little underwhelming, though. Barely anyone publishes ASAs currently and the few that are won&rsquo;t be likely to push out ASPA invalid routes any time soon. Once in a while we might find a route leak prevented by this system but it won&rsquo;t be much for a <em>while</em>.</p>
<p>However, to have some fun, we can just poke at the ASPA function and comment out a few key lines. For example: during testing I removed the line permitting Hurricane Electric, AS6939, to carry AS945&rsquo;s routes. The result was successful in that it removed any routes from AS945 with AS6939 in the AS path from BIRDs version of the &ldquo;RIB&rdquo;.</p>
<h1 id="closing">Closing<a href="#closing" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<p>I think this was a fun evening project. It didn&rsquo;t take too long and was pretty satisfying. It also taught me a bit about ASPA that I didn&rsquo;t know before.</p>
<p>If you&rsquo;d like to do this for yourself I&rsquo;d like to reiterate that ASPA is an incredibly new and unapproved standard that will undoubtedly change. I wouldn&rsquo;t do this in production quite yet. Regardless I <a href="https://github.com/kjartanhr/routinator-aspa-json-to-bird2">published my program on GitHub</a> and I encourage you, if you have any improvements, to make a pull request <img src="/owiehappy.png" alt=":owiehappy:" height="24" style="display:inline-block;margin-bottom:-8px;margin-left:-3px;" /></p>
<h1 id="some-references">Some references<a href="#some-references" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<ul>
<li><a href="https://console.rpki-client.org/">rpki-client console</a></li>
<li><a href="https://routinator.docs.nlnetlabs.nl/en/stable/">Routinator</a></li>
</ul>
<h1 id="questionscomments">Questions/comments<a href="#questionscomments" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<p>If you&rsquo;d like to ask me something or have a comment I&rsquo;d be happy chat via <a href="mailto:kjartann@kjartann.is">kjartann@kjartann.is</a>.</p>
<img src="/owiehappy.gif" alt=":owiehappy: emoji" width="48" />

      </div></div>

  
    
<div class="pagination">
    <div class="pagination__title">
        <span class="pagination__title-h">Read other posts</span>
        <hr />
    </div>
    <div class="pagination__buttons">
        
        
        <span class="button next">
            <a href="http://localhost:1313/posts/intro-internet/">
                <span class="button__text">Quick intro to how the internet really works</span>
                <span class="button__icon">→</span>
            </a>
        </span>
        
    </div>
</div>

  

  
    

  
</article>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2025 Octan Ltd. :: <a href="/credits">Credits</a></span>
    
      <span>:: <a href="/imprint">Imprint</a></span>
      </div>
  </div>
</footer>






<script type="text/javascript" src="/bundle.min.js"></script>





  
</div>


<script data-collect-dnt="true" async defer src="https://1984.as51019.com/latest.js"></script>
<noscript><img src="https://1984.as51019.com/noscript.gif?collect-dnt=true" alt="" referrerpolicy="no-referrer-when-downgrade" /></noscript>
</body>
</html>
